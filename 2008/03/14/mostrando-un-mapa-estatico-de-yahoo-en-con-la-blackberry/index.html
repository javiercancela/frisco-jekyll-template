<!DOCTYPE html>

<html lang="en">
	<head>
		<script type="text/javascript">
		    var host = "www.javiercancela.com";
		    if ((host == window.location.host) && (window.location.protocol != "https:"))
		        window.location.protocol = "https";
		</script>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="generator" content="Jekyll v3.3.1">

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300|Rubik:300">
		<link rel="stylesheet" href="/css/screen.css">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/manifest.json">
		<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
		<meta name="theme-color" content="#ffffff">

		<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Mostrando un mapa estático de Yahoo! en con la BlackBerry - Página de Javier Cancela</title>
<meta property="og:title" content="Mostrando un mapa estático de Yahoo! en con la BlackBerry" />
<meta name="description" content="Veíamos en un artículo anterior (Cómo mostrar imágenes de mapas en el móvil distintas opciones para mostrar mapas estáticos (simples imágenes de mapas, nada de JavaScript). Vamos a ver con un poco de código cómo utilizar la Yahoo! Map Image API en BlackBerry (que con algunos cambios se podrá adaptar a cualquier aplicación Java ME)." />
<meta property="og:description" content="Veíamos en un artículo anterior (Cómo mostrar imágenes de mapas en el móvil distintas opciones para mostrar mapas estáticos (simples imágenes de mapas, nada de JavaScript). Vamos a ver con un poco de código cómo utilizar la Yahoo! Map Image API en BlackBerry (que con algunos cambios se podrá adaptar a cualquier aplicación Java ME)." />
<link rel="canonical" href="https://www.javiercancela.com/2008/03/14/mostrando-un-mapa-estatico-de-yahoo-en-con-la-blackberry/" />
<meta property="og:url" content="https://www.javiercancela.com/2008/03/14/mostrando-un-mapa-estatico-de-yahoo-en-con-la-blackberry/" />
<meta property="og:site_name" content="Página de Javier Cancela" />
<meta property="og:image" content="https://www.javiercancela.com/images/obsolete.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-03-14T07:30:31+00:00" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Mostrando un mapa estático de Yahoo! en con la BlackBerry",
"image": "https://www.javiercancela.com/images/obsolete.jpg",
"datePublished": "2008-03-14T07:30:31+00:00",
"description": "Veíamos en un artículo anterior (Cómo mostrar imágenes de mapas en el móvil distintas opciones para mostrar mapas estáticos (simples imágenes de mapas, nada de JavaScript). Vamos a ver con un poco de código cómo utilizar la Yahoo! Map Image API en BlackBerry (que con algunos cambios se podrá adaptar a cualquier aplicación Java ME).",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "https://www.javiercancela.com/siteicon.png"}},
"url": "https://www.javiercancela.com/2008/03/14/mostrando-un-mapa-estatico-de-yahoo-en-con-la-blackberry/"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="https://www.javiercancela.com/feed.xml" title="Página de Javier Cancela" />

		
			<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58458863-1', 'auto');
  ga('send', 'pageview');

</script>
		
	</head>

	<body>
		<header id="mainHeader">
			<div class="container">
				<div class="company-name">
					<a href="/">
						<span class="dark-logo"><img width="104" height="38" src="/images/logo/dark.png" alt="dark frisco logo"></span>
						<span class="light-logo"><img width="104" height="38" src="/images/logo/light.png" alt="light frisco logo"></span>
					</a>
				</div>
				<nav>
	<a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
	
		
		

		
		<a href="/" class="" >Blog</a>
	
		
		

		
		<a href="/archivo/" class="" >Archivo</a>
	
		
		

		
		<a href="/sobre-mi/" class="" >Sobre mí</a>
	
</nav>

			</div>
		</header>

		<section class="hero" style="background-image: url(/images/obsolete.jpg)">
	<div class="inner-hero text-container">
		<div class="hero-text-container">
			<h1>Mostrando un mapa estático de Yahoo! en con la BlackBerry</h1>
			<p class="subtext"></p>
		</div>
	</div>
</section>

<section>
	<div class="blog-post text-container">
		<p class="post-details">
	
		
		<span class="blog-filter">
			<a href="/category/blackberry/">BlackBerry</a>
		</span>
	
	
	
	
	
	
	
	<span class="post-date">14 de marzo de 2008</span>
</p>


		<div class="post-content">
			<p>Veíamos en un artículo anterior (<a href="/2008/02/25/como-mostrar-imagenes-de-mapas-en-el-movil/">Cómo mostrar imágenes de mapas en el móvil</a> distintas opciones para mostrar mapas estáticos (simples imágenes de mapas, nada de JavaScript). Vamos a ver con un poco de código cómo utilizar la Yahoo! Map Image API en BlackBerry (que con algunos cambios se podrá adaptar a cualquier aplicación Java ME).</p>

<p>La API acepta varios parámetros para elegir la ubicación del mapa a mostrar, y nosotros vamos a utilizar como parámetros la longitud y latitud del punto central, así como el nivel de zoom y el tamaño de la imagen:</p>

<blockquote>
  <p><code class="highlighter-rouge">String url = "http://local.yahooapis.com/MapsService/V1/mapImage?appid=mi_yahoo_appid"</code></p>
</blockquote>

<blockquote>
  <p><code class="highlighter-rouge">+ "&amp;latitude=" + latitude + "&amp;longitude=" + longitude +&lt;br /&gt;
"&amp;image_height=" + height + "&amp;image_width=" + width + "&amp;zoom=" + zoom;</code></p>
</blockquote>

<p>El parámetro <code class="highlighter-rouge">mi_yahoo_appid</code> es nuestro id de aplicación de Yahoo!, que se puede obtener gratuitamente aquí: <a href="http://developer.yahoo.com/wsregapp/index.php" title="Yahoo! Application ID"><em>Yahoo! Application ID</em></a>. Con la url formada podemos realizar la llamada a la API.</p>

<blockquote>
  <p><code class="highlighter-rouge">StreamConnection s = (StreamConnection)Connector.open(url);&lt;br /&gt;
HttpConnection httpConn = (HttpConnection)s;&lt;br /&gt;
int status = httpConn.getResponseCode();&lt;br /&gt;
if (status == HttpConnection.HTTP_OK)&lt;br /&gt;
{&lt;br /&gt;
try&lt;br /&gt;
{&lt;br /&gt;
DocumentBuilder doc = DocumentBuilderFactory.newInstance().newDocumentBuilder();&lt;br /&gt;
DataInputStream dis = s.openDataInputStream();&lt;br /&gt;
Document d = doc.parse(dis);&lt;br /&gt;
Element el = d.getDocumentElement();&lt;br /&gt;
url = el.getFirstChild().getNodeValue() ;&lt;br /&gt;
dis.close();&lt;br /&gt;
}&lt;br /&gt;
catch(SAXException e)&lt;br /&gt;
{&lt;br /&gt;
System.err.println(e.toString());&lt;br /&gt;
}&lt;br /&gt;
catch(ParserConfigurationException e)&lt;br /&gt;
{&lt;br /&gt;
System.err.println(e.toString());&lt;br /&gt;
}</code></p>
</blockquote>

<p>Realizamos la conexión de forma normal, y si todo ha ido bien Yahoo! nos devolverá un documento XML:</p>

<blockquote>
  <p>`<?xml version="1.0" encoding="UTF-8"?><br /></p>
</blockquote>
<Result xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><br />
http://img.maps.yahoo.com/mapimage?MAPDATA=eJz6K.d6wXVM6myr2yRPfx6.kl.uMGgD3Tu4JtDQzr_33pFEsTT<br />
SaosZ9OCtsiDrsLv9t65fzjz0CJm6JO2v_ZIHLflY9gto.xWMK9ovlRJVmrBLO4FoSsh3Ipsr<br />
</Result>
<p>`</p>

<p>Este documento contiene un único elemento, cuyo texto es otra url que contiene la imagen solicitada en formato PNG. Para acceder a esta url, en el <em>package</em> <code class="highlighter-rouge">net.rim.device.api.xml.parsers</code> encontramos la clase <code class="highlighter-rouge">DocumentBuilder</code>, que nos permite convertir un <code class="highlighter-rouge">InputStream</code> en un objeto <code class="highlighter-rouge">Document</code> de <code class="highlighter-rouge">org.w3c.dom</code>, a partir del cual accedemos fácilmente al valor del elemento. Con esta segunda url volvemos a abrir una conexión:</p>

<blockquote>
  <p><code class="highlighter-rouge">s = (StreamConnection)Connector.open(url);&lt;br /&gt;
httpConn = (HttpConnection)s;&lt;br /&gt;
status = httpConn.getResponseCode();&lt;br /&gt;
if (status == HttpConnection.HTTP_OK)&lt;br /&gt;
{&lt;br /&gt;
java.io.InputStream input = s.openInputStream();&lt;br /&gt;
byte[] data = new byte[1];&lt;br /&gt;
ByteVector bv = new ByteVector();&lt;br /&gt;
while ( -1 != input.read(data) )&lt;br /&gt;
{&lt;br /&gt;
bv.addElement(data[0]);&lt;br /&gt;
}&lt;br /&gt;
Bitmap bitmap = Bitmap.createBitmapFromPNG(bv.getArray(), 0, -1);&lt;br /&gt;
// Mostramos la imagen almacenada en el bitmap&lt;br /&gt;
}</code></p>
</blockquote>

<p>Esta vez utilizamos el flujo de bytes devuelto para crear un <code class="highlighter-rouge">Bitmap</code>. No podemos utilizar el método <code class="highlighter-rouge">getLength()</code> de la conexión para averiguar el número de bytes total porque las cabeceras de la página no incluyen el campo Content-Length. Así que recorremos byte byte el stream para obtener un array de bytes con el que generar el <code class="highlighter-rouge">Bitmap</code>.</p>

<p>Ya tenemos nuestro <code class="highlighter-rouge">Bitmap</code> para mostrar. Bastará añadir, por ejemplo, un <code class="highlighter-rouge">BitmapField</code> y asignarle el <code class="highlighter-rouge">Bitmap</code> recién creado.</p>


			<div class="blog-navigation">
				
					<a class="prev" href="/2008/03/13/acceder-a-internet-con-java-en-una-blackberry/">&laquo; Acceder a Internet con Java en una BlackBerry</a>
				
				
					<a class="next" href="/2008/03/19/nueva-sdk-de-symbian-s60-3rd-edition-feature-pack-2/">Nueva SDK de Symbian: S60 3rd Edition Feature Pack 2 &raquo;</a>
				
			</div>


			
		</div>
	</div>
</section>



		<footer>
			<div class="container">
				<p class="editor-link"><a href="cloudcannon:collections/_data/footer.yml" class="btn"><strong>&#9998;</strong> Edit footer</a></p>
				<ul class="footer-left-links">
					
						<li>
							<a  href="/" >
								
								Blog
							</a>
						</li>
					
						<li>
							<a  href="/archivo/" >
								
								Archivo
							</a>
						</li>
					
						<li>
							<a  href="/sobre-mi/" >
								
								Sobre mí
							</a>
						</li>
					
				</ul>
				<ul class="footer-right-links">
					
						<li>
							<a target="_blank" href="https://twitter.com/jcanvic" class="twitter-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	
								
							</a>
						</li>
					
						<li>
							<a target="_blank" href="https://www.linkedin.com/in/javiercancela" class="linkedin-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,19H16V13.7A1.5,1.5 0 0,0 14.5,12.2A1.5,1.5 0 0,0 13,13.7V19H10V10H13V11.2C13.5,10.36 14.59,9.8 15.5,9.8A3.5,3.5 0 0,1 19,13.3M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,19H5V10H8M20,2H4C2.89,2 2,2.89 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	
								
							</a>
						</li>
					
						<li>
							<a target="_blank" href="https://plus.google.com/+JavierCancelaVicente" class="google-plus-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z" /></svg>
	
								
							</a>
						</li>
					
						<li>
							<a  href="/feed.xml" class="rss-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
	
								
							</a>
						</li>
					
				</ul>
				<p class="copyright">
					<a href="https://cloudcannon.com/">
						Template by CloudCannon
					</a>
				</p>
			</div>
		</footer>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<script src="/js/main.js"></script>
		<script src="/js/prism.js"></script>
		<script id="dsq-count-scr" src="//javiercancela.disqus.com/count.js" async></script>
		<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		<script type="text/javascript">
			MathJax.Hub.Config({
				config: ["MMLorHTML.js"],
				extensions: ["tex2jax.js"],
				jax: ["input/TeX"],
				displayAlign: "center",
				tex2jax: {
					inlineMath: [ ['$','$'], ["\\(","\\)"] ],
					displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
					processEscapes: false
				},
				TeX: {
					extensions: ["AMSmath.js", "AMSsymbols.js"],
					TagSide: "right",
					TagIndent: ".8em",
					MultLineWidth: "85%",
					equationNumbers: {
						autoNumber: "AMS",
					},
					unicode: {
						fonts: "STIXGeneral,'Arial Unicode MS'"
					}
				},
				showProcessingMessages: false
			});
		</script>		
	</body>
</html>
