<!DOCTYPE html>

<html lang="en">

<head>
    <script type="text/javascript">
        var host = "www.javiercancela.com";
        if ((host == window.location.host) && (window.location.protocol != "https:"))
            window.location.protocol = "https";
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Jekyll v4.2.0">

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300|Rubik:300">
    <link rel="stylesheet" href="/css/screen.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff"> <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>PML T3 - Regresión logística | Página de Javier Cancela</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="PML T3 - Regresión logística" />
<meta name="author" content="Javier Cancela" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka" />
<meta property="og:description" content="Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka" />
<link rel="canonical" href="https://www.javiercancela.com/2017/05/21/python-machine-learning-vii/" />
<meta property="og:url" content="https://www.javiercancela.com/2017/05/21/python-machine-learning-vii/" />
<meta property="og:site_name" content="Página de Javier Cancela" />
<meta property="og:image" content="https://www.javiercancela.com/images/pml/pml.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-21T03:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://www.javiercancela.com/images/pml/pml.jpg" />
<meta property="twitter:title" content="PML T3 - Regresión logística" />
<script type="application/ld+json">
{"@type":"BlogPosting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.javiercancela.com/siteicon.png"},"name":"Javier Cancela"},"author":{"@type":"Person","name":"Javier Cancela"},"url":"https://www.javiercancela.com/2017/05/21/python-machine-learning-vii/","image":"https://www.javiercancela.com/images/pml/pml.jpg","headline":"PML T3 - Regresión logística","dateModified":"2017-05-21T03:00:00+02:00","datePublished":"2017-05-21T03:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.javiercancela.com/2017/05/21/python-machine-learning-vii/"},"description":"Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
  <script>
    function initFingerprintJS() {
        FingerprintJS.load().then(fp => {
            // The FingerprintJS agent is ready.
            // Get a visitor identifier when you'd like to.
            fp.get().then(result => {
                // This is the visitor identifier:
                const visitorId = result.visitorId;


                (function(i, s, o, g, r, a, m) {
                    i['GoogleAnalyticsObject'] = r;
                    i[r] = i[r] || function() {
                        (i[r].q = i[r].q || []).push(arguments)
                    }, i[r].l = 1 * new Date();
                    a = s.createElement(o),
                        m = s.getElementsByTagName(o)[0];
                    a.async = 1;
                    a.src = g;
                    m.parentNode.insertBefore(a, m)
                })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

                ga('create', 'UA-58458863-1', {
                    'storage': 'none',
                    'clientId': visitorId
                });
                ga('set', 'anonymizeIp', true);
                ga('send', 'pageview');
            });
        });
    }
</script>
<script async src="//cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js" onload="initFingerprintJS()"></script> 
</head>

<body>
    <header id="mainHeader">
        <div class="container">
            <div class="company-name">
                <a href="/">
                    <span class="dark-logo"><img width="104" height="38" src="/images/logo/dark.png" alt="dark frisco logo"></span>
                    <span class="light-logo"><img width="104" height="38" src="/images/logo/light.png" alt="light frisco logo"></span>
                </a>
            </div>
            <nav>
	<a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
	
		
		

		
		<a href="/" class="" >Blog</a>
	
		
		

		
		<a href="/archivo/" class="" >Archivo</a>
	
		
		

		
		<a href="/sobre-mi/" class="" >Sobre mí</a>
	
</nav>

        </div>
    </header>

    <section class="hero" style="background-image: url(/images/pml/pml.jpg)">
	<div class="inner-hero text-container">
		<div class="hero-text-container">
			<h1>PML T3 - Regresión logística</h1>
			<p class="subtext">Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka</p>
		</div>
	</div>
</section>

<section>
    <div class="blog-post text-container">
        <p class="post-details">
	
		
		<span class="blog-filter">
			<a href="/category/python/">Python</a>
		</span>
	
		
		<span class="blog-filter">
			<a href="/category/libros/">Libros</a>
		</span>
	
		
		<span class="blog-filter">
			<a href="/category/machine-learning/">Machine Learning</a>
		</span>
	
		
		<span class="blog-filter">
			<a href="/category/inteligencia-artificial/">Inteligencia Artificial</a>
		</span>
	
	
	
	
	
	
	
	<span class="post-date">21 de mayo de 2017</span>
</p>


        <div class="post-content">
            <p>Seguimos con algunos conceptos estadísticos útiles para estudiar el modelo de regresión logística.</p>

<h3 id="predicción-de-categorías">Predicción de categorías</h3>

<p>La principal característica de la regresión logística es que la variable respuesta es una categoría, no un valor continuo. Siguiendo con el ejemplo de la entrada anterior, la regresión logística nos permitiría relacionar las horas dedicadas al estudio con la categoría final de la nota: suspenso o aprobado. Este tipo de regresión logística, con dos posibles categorías para el resultado, se llama regresión logística binaria.</p>

<p>La regresión logística estima la probabilidad de que una característica esté presente en la muestra para los valores de las variables predictoras dadas. Estos valores pueden ser continuos, discretos, categóricos o una mezcla de varios. En el caso de que queramos estimar la probabilidad de que una persona desarrolle cáncer de pulmón (y por lo tanto predecir, por ejemplo, si lo va a desarrollar en los próximos 5 años), podríamos utilizar como factores predictores el tiempo que lleva fumando (una variable continua), la cantidad de cigarrillos (una variable discreta), y si tiene o no antecedentes familiares (una categoría con dos posibles valores).</p>

<p>Todos esos factores se incorporarían al modelo de la siguiente forma. Sea \(Y\) la variable respuesta. Para una persona (muestra) \(i\), existen dos posibles valores:</p>

\[Y_i = 1 \rightarrow \text{  la persona desarrollará la enfermedad}\]

\[Y_i = 0 \rightarrow \text{  la persona no desarrollará la enfermedad}\]

<p>El conjunto de variables predictoras lo modelaremos a través de \(X = (X_1, X_2, ..., X_k)\), donde \(x_i\) es el valor observado para la persona (muestra) \(i\). Para simplificar el modelo, nos centraremos en una única variable predictora \(X\). El modelo intentará encontrar la probabilidad de que la persona desarrolle la enfermedad (\(Y_i=1\)) para un valor predictor concreto (\(X_i=x_i\)):</p>

\[\pi_i=Pr(Y_i=1|X_i=x_i) \text{  (1)}\]

<h3 id="la-función-logística">La función logística</h3>

<p>La <a href="https://es.wikipedia.org/wiki/Funci%C3%B3n_log%C3%ADstica">función logística</a> es la curva definida por la siguiente ecuación:</p>

\[f(x)=\dfrac{L}{1+e^{-k(x-x_0)}}\]

<p>Un caso especial de esta función es la <a href="https://es.wikipedia.org/wiki/Funci%C3%B3n_sigmoide">función sigmoidea</a>, donde \(L=1\), \(k=1\) y \(x_0=0\):</p>

\[f(x)=\dfrac{1}{1+e^{-x}} \text{  (2)}\]

<div style="text-align:center">
    <figure>
        <img alt="Función sigmoidea sacada de la wikipedia" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Logistic-curve.svg/600px-Logistic-curve.svg.png" />
        <figcaption>Función sigmoidea sacada de la wikipedia</figcaption>
    </figure>
</div>

<p>Este tipo de función tiene múltiples usos en distintas disciplinas científicas. En nuestro caso, nos interesa porque los valores de \(f(x)\) tienen a \(L\) o \(-L\) según \(x\) tiene a \(\infty\) o \(-\infty\). Si \(L=1\), se puede interpretar que esta funcion asigna una probabilidad a un suceso en función de \(x\). En el caso de una red neuronal, la entrada neta al sistema no será \(x\), sino \(z=w_0x_0+w_1x_1\) (para el caso de una única variable predictora), que podemos simplificar como \(\beta_0 + \beta_1x\). Por tanto, de \(\text{(1)}\) y \(\text{(2)}\):</p>

\[Pr(Y_i=1|Z_i=z_i)=\phi(z)=\dfrac{1}{1+e^{-z}}\]

<p>y multiplicando arriba y abajo por \(e^z\):</p>

\[\phi(z)=\dfrac{e^z}{1+e^z}\]

<p>Como los valores de \(\phi(z)\) van a variar entre 0 y 1, podemos establecer como regla para categorizar muestras que la categoría predicha \(\hat y\) valdrá:</p>

\[\hat y = \begin{cases}
\text{1 si } \phi(z) \ge 0.5 \cr
\text{-1 en otro caso}
\end{cases}\]

<p>Utilizaremos estas ideas en la siguiente entrada para plantear el algoritmo de regresión lineal.</p>



            <div class="blog-navigation">
                
                <a class="prev" href="/2017/05/14/python-machine-learning-vi/">&laquo; PML T3 - Regresión lineal</a>  
                <a class="next" href="/2017/05/28/python-machine-learning-viii/">PML T3 - Algoritmo con regresión logística &raquo;</a> 
            </div>
        </div>
    </div>
</section>


    <footer>
        <div class="container">
            <p class="editor-link"><a href="cloudcannon:collections/_data/footer.yml" class="btn"><strong>&#9998;</strong> Edit footer</a></p>
            <ul class="footer-right-links">
                
                <li>
                    <a target="_blank"  href="https://twitter.com/javier_cancela_" class="twitter-icon" >
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	
								
							</a>
                </li>
                
                <li>
                    <a target="_blank"  href="https://www.linkedin.com/in/javiercancela" class="linkedin-icon" >
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,19H16V13.7A1.5,1.5 0 0,0 14.5,12.2A1.5,1.5 0 0,0 13,13.7V19H10V10H13V11.2C13.5,10.36 14.59,9.8 15.5,9.8A3.5,3.5 0 0,1 19,13.3M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,19H5V10H8M20,2H4C2.89,2 2,2.89 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	
								
							</a>
                </li>
                
                <li>
                    <a  href="/feed.xml" class="rss-icon" >
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
	
								
							</a>
                </li>
                
            </ul>
            <p class="copyright">
                <a href="https://cloudcannon.com/">
						Template by CloudCannon
					</a>
            </p>
        </div>
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/prism.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript">
        MathJax.Hub.Config({
            config: ["MMLorHTML.js"],
            extensions: ["tex2jax.js"],
            jax: ["input/TeX"],
            displayAlign: "center",
            tex2jax: {
                inlineMath: [
                    ['$', '$'],
                    ["\\(", "\\)"]
                ],
                displayMath: [
                    ['$$', '$$'],
                    ["\\[", "\\]"]
                ],
                processEscapes: false
            },
            TeX: {
                extensions: ["AMSmath.js", "AMSsymbols.js"],
                TagSide: "right",
                TagIndent: ".8em",
                MultLineWidth: "85%",
                equationNumbers: {
                    autoNumber: "AMS",
                },
                unicode: {
                    fonts: "STIXGeneral,'Arial Unicode MS'"
                }
            },
            showProcessingMessages: false
        });
    </script>
</body>

</html>