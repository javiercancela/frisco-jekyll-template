<!DOCTYPE html>

<html lang="en">
	<head>
		<script type="text/javascript">
		    var host = "www.javiercancela.com";
		    if ((host == window.location.host) && (window.location.protocol != "https:"))
		        window.location.protocol = "https";
		</script>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="generator" content="Jekyll v3.8.6">

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300|Rubik:300">
		<link rel="stylesheet" href="/css/screen.css">
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/manifest.json">
		<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
		<meta name="theme-color" content="#ffffff">

		<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>PML T3 - Algoritmo con regresión logística - Página de Javier Cancela</title>
<meta property="og:title" content="PML T3 - Algoritmo con regresión logística" />
<meta name="description" content="Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka" />
<meta property="og:description" content="Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka" />
<link rel="canonical" href="https://www.javiercancela.com/2017/05/28/python-machine-learning-viii/" />
<meta property="og:url" content="https://www.javiercancela.com/2017/05/28/python-machine-learning-viii/" />
<meta property="og:site_name" content="Página de Javier Cancela" />
<meta property="og:image" content="https://www.javiercancela.com/images/pml/pml.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-28T03:00:00+02:00" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "PML T3 - Algoritmo con regresión logística",
"image": "https://www.javiercancela.com/images/pml/pml.jpg",
"datePublished": "2017-05-28T03:00:00+02:00",
"description": "Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "https://www.javiercancela.com/siteicon.png"}},
"url": "https://www.javiercancela.com/2017/05/28/python-machine-learning-viii/"}</script>
<!-- End Jekyll SEO tag -->


		
			<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58458863-1', 'auto');
  ga('send', 'pageview');

</script>
		
	</head>

	<body>
		<header id="mainHeader">
			<div class="container">
				<div class="company-name">
					<a href="/">
						<span class="dark-logo"><img width="104" height="38" src="/images/logo/dark.png" alt="dark frisco logo"></span>
						<span class="light-logo"><img width="104" height="38" src="/images/logo/light.png" alt="light frisco logo"></span>
					</a>
				</div>
				<nav>
	<a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
	
		
		

		
		<a href="/" class="" >Blog</a>
	
		
		

		
		<a href="/archivo/" class="" >Archivo</a>
	
		
		

		
		<a href="/sobre-mi/" class="" >Sobre mí</a>
	
</nav>

			</div>
		</header>

		<section class="hero" style="background-image: url(/images/pml/pml.jpg)">
	<div class="inner-hero text-container">
		<div class="hero-text-container">
			<h1>PML T3 - Algoritmo con regresión logística</h1>
			<p class="subtext">Python Machine Learning - Tema 3 - Notas sobre el libro de Sebastian Raschka</p>
		</div>
	</div>
</section>

<section>
	<div class="blog-post text-container">
		<p class="post-details">
	
		
		<span class="blog-filter">
			<a href="/category/python/">Python</a>
		</span>
	
		
		<span class="blog-filter">
			<a href="/category/libros/">Libros</a>
		</span>
	
		
		<span class="blog-filter">
			<a href="/category/machine-learning/">Machine Learning</a>
		</span>
	
		
		<span class="blog-filter">
			<a href="/category/inteligencia-artificial/">Inteligencia Artificial</a>
		</span>
	
	
	
	
	
	
	
	<span class="post-date">28 de mayo de 2017</span>
</p>


		<div class="post-content">
			<p>A partir del concepto de <a href="/2017/05/21/python-machine-learning-vii/">regresión logística</a> 
podemos ya definir el siguiente algoritmo.</p>

<h2 id="el-modelo-para-la-regresión-logística">El modelo para la regresión logística</h2>

<p>El libro traza un paralelo con el modelo <a href="/2017/04/02/python-machine-learning-iii/">ADALINE</a>, donde la función indentidad (<script type="math/tex">\phi(z)=z</script>) es sustituida por la función logística (sigmoidea) en nuestro modelo:</p>

<div style="text-align:center">
    <figure>
        <img alt="El algoritmo de ADALINE con la función identidad sustituida por la función logística o sigmoidea" src="https://raw.githubusercontent.com/rasbt/python-machine-learning-book/master/code/ch03/images/03_03.png" />
        <figcaption>El algoritmo de ADALINE con la función identidad sustituida por la función logística o sigmoidea</figcaption>
    </figure>
</div>

<h3 id="cálculo-de-los-pesos">Cálculo de los pesos</h3>

<p>Cuando hablamos de ADALINE definimos la <a href="/2017/04/02/python-machine-learning-iii/#1">función de costos de la suma de los errores cuadrados</a> para minimizarla:</p>

<script type="math/tex; mode=display">J({\mathbf{w}}) = \frac{1}{2} \sum_i \big(y^{(i)} - \phi(z)_{A}^{(i)}\big)^2.</script>

<p>Para obtener una función de costos que minimizar, el autor empieza definiendo la siguiente función:</p>

<script type="math/tex; mode=display">L(\mathbf{w}) = P(\mathbf{y} | \mathbf{x}; \mathbf{w}) = \prod_{i=1}^{n} P \big( y^{(i)} | x^{(i)}; \mathbf{w} \big) =  \prod_{i=1}^{n} \bigg( \phi \big(z^{(i)} \big) \bigg) ^ {y^{(i)}} \bigg( 1 - \phi \big( z^{(i)} \big) \bigg)^{1-y^{(i)}},</script>

<p>donde <script type="math/tex">y^{(i)}</script> es la clase (<script type="math/tex">1</script> o <script type="math/tex">0</script>) de la muestra <script type="math/tex">i</script>, y <script type="math/tex">\phi \big(z^{(i)} \big)</script> es la probabilidad de que la muestra <script type="math/tex">i</script> pertenezca a la clase <script type="math/tex">1</script>. Como vimos en la entrada anterior, la clase predicha <script type="math/tex">\hat y</script> será <script type="math/tex">1</script> si la probabilidad de es mayor o igual a <script type="math/tex">0.5</script>.</p>

<p>Por tanto, la expresión</p>

<script type="math/tex; mode=display">\bigg( \phi \big(z^{(i)} \big) \bigg) ^ {y^{(i)}} \bigg( 1 - \phi \big( z^{(i)} \big) \bigg)^{1-y^{(i)}}</script>

<p>indica la probabilidad de que la muestra <script type="math/tex">i</script> pertenezca a la clase real (<script type="math/tex">y^{(i)}</script>), ya que si <script type="math/tex">y^{(i)} = 1</script>, la expresión se simplifica a <script type="math/tex">\phi \big(z^{(i)} \big)</script>, y si <script type="math/tex">y^{(i)} = 0</script> nos queda</p>

<script type="math/tex; mode=display">\bigg( 1 - \phi \big( z^{(i)} \big) \bigg)^{1-y^{(i)}},</script>

<p>que es la probabilidad de que la muestra sea de clase distinta de <script type="math/tex">1</script>, es decir, la probabilidad de que se de clase <script type="math/tex">0</script>.</p>

<p>Entonces, la función <script type="math/tex">L(\mathbf{w})</script> es el producto de las probabilidades de que cada muestra sea de su clase real, en función de los pesos <script type="math/tex">\mathbf{w}</script> establecidos. Si maximizamos esa función, estaremos maximizando la calidad de la predicción para el conjunto de muestras.</p>

<h3 id="simplificando-los-cálculos">Simplificando los cálculos</h3>

<p>El siguiente paso que da el libro es calcular el logaritmo de <script type="math/tex">L(\mathbf{w})</script>. El propósito de esta función es doble. Por un lado, evita un problema potencial si las probabilidades son lo suficientemente pequeñas para que su producto provoque un desbordamiento. El logaritmo convierte los productos en sumas, con lo que el riesgo desaparece. Por otro lado, el cálculo de la derivada se simplifica mucho por el mismo motivo.</p>

<script type="math/tex; mode=display">l(\mathbf{w}) = \log L(\mathbf{w}) = \log \Bigg[ \prod_{i=1}^{n} \bigg( \phi \big(z^{(i)} \big) \bigg) ^ {y^{(i)}} \bigg( 1 - \phi \big( z^{(i)} \big) \bigg)^{1-y^{(i)}}  \Bigg]</script>

<p>Dado que <script type="math/tex">\log (xy) = \log x + \log y</script>, el logaritmo del productorio se convierte en un sumatorio de logaritmos:</p>

<script type="math/tex; mode=display">l(\mathbf{w}) = \sum_{i=1}^{n} \Bigg[ \log \bigg( \bigg( \phi \big(z^{(i)} \big) \bigg) ^ {y^{(i)}} \bigg( 1 - \phi \big( z^{(i)} \big) \bigg)^{1-y^{(i)}} \bigg) \Bigg].</script>

<p>Ahora el sumatorio contiene también el logaritmo de un producto, por lo que podemos convertirlo en:</p>

<script type="math/tex; mode=display">l(\mathbf{w}) = \sum_{i=1}^{n} \Bigg[ \log \bigg( \phi \big(z^{(i)} \big) \bigg) ^ {y^{(i)}} + \log \bigg( 1 - \phi \big( z^{(i)} \big) \bigg)^{1-y^{(i)}}  \Bigg].</script>

<p>Finalmente podemos simplificar usar la propiedad <script type="math/tex">\log (x^y) = y \log x</script> para convertir la expresión en:</p>

<script type="math/tex; mode=display">l(\mathbf{w}) = \sum_{i=1}^{n} \Bigg[ y^{(i)} \log \bigg( \phi \big(z^{(i)} \big) \bigg) + \bigg(1-y^{(i)} \bigg) \log \bigg( 1 - \phi \big( z^{(i)} \big) \bigg) \Bigg].</script>

<p>En la siguiente entrada veremos cómo convertir esta expresión en una función de costos.</p>


			<div class="blog-navigation">
				
					<a class="prev" href="/2017/05/21/python-machine-learning-vii/">&laquo; PML T3 - Regresión logística</a>
				
				
					<a class="next" href="/2018/02/26/deep-learning-00/">Deep learning - Prólogo &raquo;</a>
				
			</div>


			
				<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    
    var disqus_config = function () {
        this.page.url = "http://www.javiercancela.com/2017/05/28/python-machine-learning-viii/";  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = "/2017/05/28/python-machine-learning-viii"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//javiercancela.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
			
		</div>
	</div>
</section>



		<footer>
			<div class="container">
				<p class="editor-link"><a href="cloudcannon:collections/_data/footer.yml" class="btn"><strong>&#9998;</strong> Edit footer</a></p>
				<ul class="footer-left-links">
					
						<li>
							<a  href="/" >
								
								Blog
							</a>
						</li>
					
						<li>
							<a  href="/archivo/" >
								
								Archivo
							</a>
						</li>
					
						<li>
							<a  href="/sobre-mi/" >
								
								Sobre mí
							</a>
						</li>
					
				</ul>
				<ul class="footer-right-links">
					
						<li>
							<a target="_blank" href="https://twitter.com/javier_cancela_" class="twitter-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	
								
							</a>
						</li>
					
						<li>
							<a target="_blank" href="https://www.linkedin.com/in/javiercancela" class="linkedin-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,19H16V13.7A1.5,1.5 0 0,0 14.5,12.2A1.5,1.5 0 0,0 13,13.7V19H10V10H13V11.2C13.5,10.36 14.59,9.8 15.5,9.8A3.5,3.5 0 0,1 19,13.3M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,19H5V10H8M20,2H4C2.89,2 2,2.89 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	
								
							</a>
						</li>
					
						<li>
							<a  href="/feed.xml" class="rss-icon">
								
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
	
								
							</a>
						</li>
					
				</ul>
				<p class="copyright">
					<a href="https://cloudcannon.com/">
						Template by CloudCannon
					</a>
				</p>
			</div>
		</footer>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<script src="/js/main.js"></script>
		<script src="/js/prism.js"></script>
		<script id="dsq-count-scr" src="//javiercancela.disqus.com/count.js" async></script>
		<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		<script type="text/javascript">
			MathJax.Hub.Config({
				config: ["MMLorHTML.js"],
				extensions: ["tex2jax.js"],
				jax: ["input/TeX"],
				displayAlign: "center",
				tex2jax: {
					inlineMath: [ ['$','$'], ["\\(","\\)"] ],
					displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
					processEscapes: false
				},
				TeX: {
					extensions: ["AMSmath.js", "AMSsymbols.js"],
					TagSide: "right",
					TagIndent: ".8em",
					MultLineWidth: "85%",
					equationNumbers: {
						autoNumber: "AMS",
					},
					unicode: {
						fonts: "STIXGeneral,'Arial Unicode MS'"
					}
				},
				showProcessingMessages: false
			});
		</script>		
	</body>
</html>
